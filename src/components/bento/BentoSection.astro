---
import BentoCard from './BentoCard.astro';
import GithubActivity from './GithubActivity.astro';
import BentoItemTypingSpeed from './BentoItemTypingSpeed.astro';
import BentoItemMapLocation from './BentoItemMapLocation.astro';
import BentoItemDiscoverMore from './BentoItemDiscoverMore.tsx';
import BentoItemTechStack from './BentoItemTechStack.astro';
import { LocationIcon, FeaturedWorkIcon, SpotifyIcon, GithubIcon, TechStackIcon, ProjectsIcon } from '../icons/BentoIcons';
import { Monkeytype } from '../icons/Monkeytype';
import { LinkedIn } from '../icons/LinkedIn';
import BentoItemNowPlaying from './BentoItemNowPlaying.astro';
---

<div id="bento" class="w-full max-w-[1120px] mx-auto px-4 sm:px-6 pt-16 sm:pt-28">
  <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-14 auto-rows-auto gap-4">
    <!-- Location Card -->
    <div class="sm:col-span-1 lg:col-span-4 min-h-[250px] sm:min-h-[300px]">
      <BentoCard className="h-full">
        <BentoItemMapLocation />
      </BentoCard>
    </div>

    <!-- Featured Work Card -->
    <div class="sm:col-span-1 lg:col-span-5 min-h-[250px] sm:min-h-[300px]">
      <BentoCard title="Featured work" icon={FeaturedWorkIcon} className="h-full">
        Featured work placeholder
      </BentoCard>
    </div>

    <!-- Spotify Card -->
    <div class="sm:col-span-1 lg:col-span-5">
      <BentoCard className="h-full min-h-[120px]">
        <BentoItemNowPlaying />
      </BentoCard>
    </div>

    <!-- Typing Speed Card -->
    <div class="sm:col-span-1 lg:col-span-5 min-h-[200px] sm:min-h-[250px]">
      <BentoCard title="Typing speed" icon={Monkeytype} className="h-full">
        <BentoItemTypingSpeed />
      </BentoCard>
    </div>

    <!-- Social Media Row -->
    <div class="sm:col-span-1 lg:col-span-4 flex gap-4">
      <div class="flex-1">
        <a href="https://github.com/amirabaskanov" target="_blank" rel="noopener noreferrer" class="block group/social">
          <div class="group relative rounded-[32px] border border-[#2A3441] bg-[#0f1219] overflow-hidden aspect-square">
            <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition duration-300 [background:radial-gradient(600px_circle_at_var(--mouse-x)_var(--mouse-y),rgba(255,255,255,0.06),transparent_40%)]" />
            <div class="p-4 sm:p-6 h-full flex items-center justify-center">
              <GithubIcon className="w-6 h-6 sm:w-8 sm:h-8 text-white group-hover/social:text-[#1EF4AE] transition-colors" />
            </div>
          </div>
        </a>
      </div>

      <div class="flex-1">
        <a href="https://linkedin.com/in/abaskanov" target="_blank" rel="noopener noreferrer" class="block group/social">
          <div class="group relative rounded-[32px] border border-[#2A3441] bg-[#0f1219] overflow-hidden aspect-square">
            <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition duration-300 [background:radial-gradient(600px_circle_at_var(--mouse-x)_var(--mouse-y),rgba(255,255,255,0.06),transparent_40%)]" />
            <div class="p-4 sm:p-6 h-full flex items-center justify-center">
              <LinkedIn className="w-6 h-6 sm:w-8 sm:h-8 text-white group-hover/social:text-[#1EF4AE] transition-colors" />
            </div>
          </div>
        </a>
      </div>

      <div class="flex-1">
        <a href="https://instagram.com/amirabaskanov" target="_blank" rel="noopener noreferrer" class="block group/social">
          <div class="group relative rounded-[32px] border border-[#2A3441] bg-[#0f1219] overflow-hidden aspect-square">
            <div class="absolute inset-0 opacity-0 group-hover:opacity-100 transition duration-300 [background:radial-gradient(600px_circle_at_var(--mouse-x)_var(--mouse-y),rgba(255,255,255,0.06),transparent_40%)]" />
            <div class="p-4 sm:p-6 h-full flex items-center justify-center">
              <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 sm:w-8 sm:h-8 text-white group-hover/social:text-[#1EF4AE] transition-colors" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect width="20" height="20" x="2" y="2" rx="5" ry="5" />
                <path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z" />
                <line x1="17.5" x2="17.51" y1="6.5" y2="6.5" />
              </svg>
            </div>
          </div>
        </a>
      </div>
    </div>

    <!-- Discover More -->
    <div class="sm:col-span-1 lg:col-span-5">
      <BentoCard className="h-full min-h-[90px]">
        <BentoItemDiscoverMore client:load />
      </BentoCard>
    </div>

    <!-- Bottom Row -->
    <div class="sm:col-span-2 lg:col-span-7 min-h-[250px] sm:min-h-[300px]">
      <BentoCard title="Github activity" icon={GithubIcon} className="h-full">
        <div class="flex items-center justify-between">
          <GithubActivity username="amirabaskanov" />
          <div class="text-white text-[14px] contribution-info absolute top-8 right-6">
            <span>Loading contributions...</span>
          </div>
        </div>
      </BentoCard>
    </div>

    <div class="sm:col-span-2 lg:col-span-7 min-h-[250px] sm:min-h-[300px]">
      <BentoCard title="Tech stack" icon={TechStackIcon} className="h-full">
        <BentoItemTechStack />
      </BentoCard>
    </div>
  </div>
</div>

<script>
  const handleMouseMove = (e: MouseEvent, card: HTMLElement) => {
    const rect = card.getBoundingClientRect();
    const x = e.clientX - rect.left;
    const y = e.clientY - rect.top;
    
    card.style.setProperty("--mouse-x", `${x}px`);
    card.style.setProperty("--mouse-y", `${y}px`);
  };

  document.addEventListener("astro:page-load", () => {
    document.querySelectorAll<HTMLElement>(".group").forEach((card) => {
      card.addEventListener("mousemove", (e) => handleMouseMove(e, card));
    });
  });
</script>
